# Diagonal MFA configuration for CIFAR-10 (grayscale, 1024 dims)
defaults:
  - mfa-diagonal
  - _self_

latent_dim: 10
n_clusters: 10
init_scale: 0.01
min_var: 0.01

trainer:
  lr: 3e-6
  n_epochs: 2000
  # batch_size: 1024
  batch_steps: 1000
  grad_clip: 1.0

  # Regularization
  l1_reg: 1e-4
  l2_reg: 1e-4
  upr_prs_reg: 1e-3
  lwr_prs_reg: 1e-3

  min_prob: 1e-3
  obs_min_var: 1e-4
  lat_min_var: 1e-6

  # Jitter (optional)
  obs_jitter_var: 0.0
  lat_jitter_var: 0.0

analyses:
  generative_samples:
    enabled: true
    n_samples: 100
  cluster_statistics:
    enabled: true
  co_assignment_hierarchy:
    enabled: true
  co_assignment_merge:
    enabled: true
  optimal_merge:
    enabled: false
